<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.4.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.4.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=6.4.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=6.4.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.4.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '6.4.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="本文转自 code秘密花园. 本文有点长，耐心阅读！">
<meta name="keywords" content="前端">
<meta property="og:type" content="article">
<meta property="og:title" content="关于移动端适配，你必须要知道的">
<meta property="og:url" content="https://Lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/index.html">
<meta property="og:site_name" content="Charli">
<meta property="og:description" content="本文转自 code秘密花园. 本文有点长，耐心阅读！">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/view.jpg">
<meta property="og:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/01.webp">
<meta property="og:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/02.jpg">
<meta property="og:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/03.jpg">
<meta property="og:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/04.webp">
<meta property="og:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/05.webp">
<meta property="og:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/PPI.jpg">
<meta property="og:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/06.webp">
<meta property="og:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/07.webp">
<meta property="og:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/08.webp">
<meta property="og:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/09.webp">
<meta property="og:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/10.webp">
<meta property="og:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/11.webp">
<meta property="og:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/12.webp">
<meta property="og:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/13.webp">
<meta property="og:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/14.webp">
<meta property="og:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/15.webp">
<meta property="og:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/16.webp">
<meta property="og:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/17.webp">
<meta property="og:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/18.webp">
<meta property="og:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/19.webp">
<meta property="og:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/20.webp">
<meta property="og:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/21.webp">
<meta property="og:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/22.webp">
<meta property="og:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/23.webp">
<meta property="og:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/24.webp">
<meta property="og:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/25.webp">
<meta property="og:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/26.webp">
<meta property="og:updated_time" content="2022-05-24T10:36:01.006Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="关于移动端适配，你必须要知道的">
<meta name="twitter:description" content="本文转自 code秘密花园. 本文有点长，耐心阅读！">
<meta name="twitter:image" content="https://lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/view.jpg">



  <link rel="alternate" href="/atom.xml" title="Charli" type="application/atom+xml" />




  <link rel="canonical" href="https://Lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>关于移动端适配，你必须要知道的 | Charli</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Charli</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">梦想的起源</p>
      
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />关于</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />标签</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />分类</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档</a>
  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://Lifuzhen.github.io/2019/06/03/关于移动端适配，你必须要知道的/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Charli">
      <meta itemprop="description" content="不积跬步，无以至千里">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Charli">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">关于移动端适配，你必须要知道的
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-06-03 18:42:28" itemprop="dateCreated datePublished" datetime="2019-06-03T18:42:28+08:00">2019-06-03</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2022-05-24 18:36:01" itemprop="dateModified" datetime="2022-05-24T18:36:01+08:00">2022-05-24</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/前端/" itemprop="url" rel="index"><span itemprop="name">前端</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/06/03/关于移动端适配，你必须要知道的/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">评论数：</span> <span class="post-comments-count valine-comment-count" data-xid="/2019/06/03/关于移动端适配，你必须要知道的/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2019/06/03/关于移动端适配，你必须要知道的/" class="leancloud_visitors" data-flag-title="关于移动端适配，你必须要知道的">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数：</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>本文转自 <a href="https://mp.weixin.qq.com/s?__biz=MzI4NDYxNTM0OQ==&amp;mid=2247483747&amp;idx=1&amp;sn=90cb7d69ca1b996809dd02a32078cd5d&amp;chksm=ebf9f6b9dc8e7faf867e5ec22339e65efdb0002bc7d9f1867a53edb8c5318a94a8d13737a269&amp;mpshare=1&amp;scene=1&amp;srcid=&amp;key=47a58d19edbb3f926e528c56a70e589ae4e1cf407b6c9c8b6d9a12d873ac30d5305221e22dec0e82151432be214eab8486154ff64e20d56ad7cdcb461faaebe75242d05895b2e35d5cc7ed48027ebeee&amp;ascene=1&amp;uin=Mjk1MDEwMzIwNw%3D%3D&amp;devicetype=Windows+10&amp;version=62060739&amp;lang=en&amp;pass_ticket=Kg%2BuI6pXTVeQSCOOiejokLvubZ6zl%2FsBhrz7K%2B4cm%2B%2FtjWT1MFYKGhT2efwdnKdG" target="_blank" rel="noopener">code秘密花园</a>.</p>
<p>本文有点长，耐心阅读！<br><img src="/2019/06/03/关于移动端适配，你必须要知道的/view.jpg" alt="view"><br><a id="more"></a><br><strong>导读</strong></p>
<p>移动端适配，是我们在开发中经常会遇到的，这里面可能会遇到非常多的问题：</p>
<ul>
<li>1px问题</li>
<li>UI图完美适配方案</li>
<li>iPhoneX适配方案</li>
<li>横屏适配</li>
<li>高清图片模糊问题</li>
<li>…<br>上面这些问题可能我们在开发中已经知道如何解决，但是问题产生的原理，以及解决方案的原理可能会模糊不清。在解决这些问题的过程中，我们往往会遇到非常多的概念：像素、分辨率、PPI、DPI、DP、DIP、DPR、视口等等，你真的能分清这些概念的意义吗？</li>
</ul>
<p>本文将从移动端适配的基础概念出发，探究移动端适配各种问题的解决方案和实现原理。</p>
<h1 id="一、英寸"><a href="#一、英寸" class="headerlink" title="一、英寸"></a>一、英寸</h1><p>一般用英寸描述屏幕的物理大小，如电脑显示器的17、22，手机显示器的4.8、5.7等使用的单位都是英寸。</p>
<p>需要注意，上面尺寸都是屏幕对角线的长度：</p>
<p><img src="/2019/06/03/关于移动端适配，你必须要知道的/01.webp" alt="01"></p>
<p>英寸（inch，缩写为in）在荷兰语中的本意是大拇指，一英寸就是普通人拇指的宽度。<br>英寸与厘米的换算：1英寸 = 2.54厘米</p>
<h1 id="二、分辨率"><a href="#二、分辨率" class="headerlink" title="二、分辨率"></a>二、分辨率</h1><h2 id="2-1-像素"><a href="#2-1-像素" class="headerlink" title="2.1 像素"></a>2.1 像素</h2><p>像素即一个小方块，它具有特定的位置和颜色。<br>图片、电子屏幕（手机、电脑）就是由无数个具有特定颜色和特定位置的小方块拼接而成。<br>像素可以作为图片或电子屏幕的最小组成单位。</p>
<p>下面我们使用ps打开一张图片：<br><img src="/2019/06/03/关于移动端适配，你必须要知道的/02.jpg" alt="02"></p>
<p>将这个图片放大即可看到这些像素点<br><img src="/2019/06/03/关于移动端适配，你必须要知道的/03.jpg" alt="03"></p>
<p>通常我们所说的分辨率有两种，屏幕分辨率和图像分辨率</p>
<h2 id="2-2-屏幕分辨率"><a href="#2-2-屏幕分辨率" class="headerlink" title="2.2 屏幕分辨率"></a>2.2 屏幕分辨率</h2><p>屏幕分辨率指一个屏幕具体由多少个像素点组成。<br>下面是apple官网上对手机分辨率的描述：<br><img src="/2019/06/03/关于移动端适配，你必须要知道的/04.webp" alt="04"><br>iPhone XS Max和iPhone SE的分辨率分别为2688 X 1242和1136 X 640.这表示手机分别在垂直和水平上所具有的像素点数。</p>
<p>当然分辨率高不代表屏幕就清晰，屏幕的清晰程度还与尺寸有关。</p>
<h2 id="2-3-图像分辨率"><a href="#2-3-图像分辨率" class="headerlink" title="2.3 图像分辨率"></a>2.3 图像分辨率</h2><p>我们通常所说的图片分辨率其实是指图片含有的像素数，比如一张图片的分辨率是800 X 400 。这表示图片分别在垂直和水平上所具有的像素点数为800和400.</p>
<p>同一尺寸的图片，分辨率越高，图片越清晰。</p>
<p><img src="/2019/06/03/关于移动端适配，你必须要知道的/05.webp" alt="05"></p>
<h2 id="2-4-PPI"><a href="#2-4-PPI" class="headerlink" title="2.4 PPI"></a>2.4 PPI</h2><p>PPI(Pixel Per Inch)：每英寸包含的像素数。<br>PPI可以用于描述屏幕的清晰度以及一张图片的质量。<br>使用PPI描述图片时，PPI越高图片质量越高。使用PPI描述屏幕时，PPI越高，屏幕越清晰。<br>在上面描述手机分辨率的图片中，我们可以看到： iPhone XSMax 和 iPhone SE的 PPI分别为458和326，这足以证明前者的屏幕更清晰。<br>由于手机尺寸为手机对角线的长度，我们通常使用如下的方法计算 PPI:<br><img src="/2019/06/03/关于移动端适配，你必须要知道的/PPI.jpg" alt="PPI"></p>
<p>iPhone6的 PPI为 √（1334^2+750^2）/4.7=325.6，那它每英寸约含有 326个物理像素点。</p>
<h2 id="2-5-DPI"><a href="#2-5-DPI" class="headerlink" title="2.5 DPI"></a>2.5 DPI</h2><p>DPI（Dot Per Inch）:及每英寸包括的点数。<br>这里的点是一个抽象的单位，它可以是屏幕像素点、图片像素点也可以是打印机的墨点。<br>平时你可能会看到使用DPI来描述图片和屏幕，这时的DPI应该和PPI是等价的，DPI最常用的是用户描述打印机，表示打印机每英寸可以打印的点数。</p>
<p>一张图片在屏幕上显示，它的像素点数是规则排列的，每个像素点都有固定的位置和颜色。</p>
<p>当使用打印机进行打印时，打印机可能不会规则的将这些点打印出来，而是使用一个个打印点来呈现这张图像，这些打印点之间会有一定的空隙，这就是DPI所描述的：打印点的密度。<br><img src="/2019/06/03/关于移动端适配，你必须要知道的/06.webp" alt="06"></p>
<p>在上面的图像中我们可以清晰的看到，打印机时如何使用墨点来打印一张图像。<br>所以打印机的DPI越高，打印图像的精细程度就越高，同时这也会消耗更多的墨点和时间。</p>
<h1 id="三、设备独立像素"><a href="#三、设备独立像素" class="headerlink" title="三、设备独立像素"></a>三、设备独立像素</h1><p>实际上，上面我们所描述的像素都是物理像素，即设备上真实的物理单元。<br>下面我们来看看设备独立像素究竟是如何产生的：<br>智能手机发展非常之快，在几年之前，我们还用着分辨率非常低的手机，比如下面左侧的白色手机，它的分辨率是320X480，我们可以在上面浏览正常的文字、图片等等。<br>但是，随着科技的发展，低分辨率的手机已经不能满足我们的需求了。很快，更高分辨率的屏幕诞生了，比如下面的黑色手机，它的分辨率是640X940，正好是白色手机的两倍。<br>理论上来讲，在白色手机上相同文字大小的图片和文字，在黑色手机上会被缩放一倍，因为它的分辨率提高了一倍。这样，岂不是后面出现更高分辨率的手机，页面元素会变得越来越小吗？<br><img src="/2019/06/03/关于移动端适配，你必须要知道的/07.webp" alt="07"><br>然而事实并不是这样的，我们现在使用的智能手机，不管分辨率多高，他们所展示的界面比例都是基本类似的。乔布斯在 iPhone4的发布会上首次提出了 RetinaDisplay(视网膜屏幕)的概念，它正是解决了上面的问题，这也使它成为一款跨时代的手机。</p>
<p><img src="/2019/06/03/关于移动端适配，你必须要知道的/08.webp" alt="08"></p>
<p>在 iPhone4使用的视网膜屏幕中，把 2x2个像素当 1个像素使用，这样让屏幕看起来更精致，但是元素的大小却不会改变。</p>
<p><img src="/2019/06/03/关于移动端适配，你必须要知道的/09.webp" alt="09"></p>
<p>如果黑色手机使用了视网膜屏幕的技术，那么显示结果应该是下面的情况，比如列表的宽度为 300个像素，那么在一条水平线上，白色手机会用 300个物理像素去渲染它，而黑色手机实际上会用 600个物理像素去渲染它。</p>
<p>我们必须用一种单位来同时告诉不同分辨率的手机，它们在界面上显示元素的大小是多少，这个单位就是设备独立像素( DeviceIndependentPixels)简称 DIP或 DP。上面我们说，列表的宽度为 300个像素，实际上我们可以说：列表的宽度为 300个设备独立像素。</p>
<p><img src="/2019/06/03/关于移动端适配，你必须要知道的/10.webp" alt="10"></p>
<p>打开 chrome的开发者工具，我们可以模拟各个手机型号的显示情况，每种型号上面会显示一个尺寸，比如 iPhone X显示的尺寸是 375x812，实际 iPhone X的分辨率会比这高很多，这里显示的就是设备独立像素。</p>
<p><img src="/2019/06/03/关于移动端适配，你必须要知道的/11.webp" alt="11"></p>
<h2 id="3-1-设备像素比"><a href="#3-1-设备像素比" class="headerlink" title="3.1 设备像素比"></a>3.1 设备像素比</h2><p>设备像素比 device pixel ratio简称 dpr，即物理像素和设备独立像素的比值。<br>在 web中，浏览器为我们提供了 window.devicePixelRatio来帮助我们获取 dpr。<br>在 css中，可以使用媒体查询 min-device-pixel-ratio，区分 dpr：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@media(-webkit-min-device-pixel-ratio: 2),(min-device-pixel-ratio: 2)&#123; &#125;</span><br></pre></td></tr></table></figure></p>
<p>在 ReactNative中，我们也可以使用 PixelRatio.get()来获取 DPR。</p>
<p>当然，上面的规则也有例外， iPhone6、7、8Plus的实际物理像素是 1080x1920，在开发者工具中我们可以看到：它的设备独立像素是 414x736，设备像素比为 3，设备独立像素和设备像素比的乘积并不等于 1080x1920，而是等于 1242x2208。</p>
<p>实际上，手机会自动把 1242x2208个像素点塞进 1080*1920个物理像素点来渲染，我们不用关心这个过程，而 1242x2208被称为屏幕的设计像素。我们开发过程中也是以这个设计像素为准。</p>
<p>实际上，从苹果提出视网膜屏幕开始，才出现设备像素比这个概念，因为在这之前，移动设备都是直接使用物理像素来进行展示。</p>
<p>紧接着， Android同样使用了其他的技术方案来实现 DPR大于 1的屏幕，不过原理是类似的。由于 Android屏幕尺寸非常多、分辨率高低跨度非常大，不像苹果只有它自己的几款固定设备、尺寸。所以，为了保证各种设备的显示效果， Android按照设备的像素密度将设备分成了几个区间：<br><img src="/2019/06/03/关于移动端适配，你必须要知道的/12.webp" alt="12"><br>当然，所有的 Android设备不一定严格按照上面的分辨率，每个类型可能对应几种不同分辨率，所以，每个 Android手机都能根据给定的区间范围，确定自己的 DPR，从而拥有类似的显示。当然，仅仅是类似，由于各个设备的尺寸、分辨率上的差异，设备独立像素也不会完全相等，所以各种 Android设备仍然不能做到在展示上完全相等。</p>
<h2 id="3-2-移动端开发"><a href="#3-2-移动端开发" class="headerlink" title="3.2 移动端开发"></a>3.2 移动端开发</h2><p>在 iOS、Android和ReactNative开发中样式单位其实都使用的是设备独立像素。</p>
<p>iOS的尺寸单位为pt， Android的尺寸单位为dp，ReactNative中没有指定明确的单位，它们其实都是设备独立像素dp。<br>在使用ReactNative开发App时，UI给我们的原型图一般是基于iphone6的像素给定的。</p>
<p>为了适配所有机型，我们在写样式时需要把物理像素转换为设备独立像素：例如：如果给定一个元素的高度为200px(这里的 px指物理像素，非 CSS像素)，iphone6的设备像素比为2，我们给定的height应为200px/2=100dp。</p>
<p>当然，最好的是，你可以和设计沟通好，所有的UI图都按照设备独立像素来出。</p>
<p>我们还可以在代码( ReactNative)中进行 px和 dp的转换：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import &#123;PixelRatio &#125; from &apos;react-native&apos;;</span><br><span class="line">    const dpr = PixelRatio.get();</span><br><span class="line">/**</span><br><span class="line"> * px转换为dp</span><br><span class="line"> */</span><br><span class="line">export function pxConvertTodp(px) &#123;  </span><br><span class="line">    return px / dpr;</span><br><span class="line">&#125;</span><br><span class="line">/**</span><br><span class="line"> * dp转换为px</span><br><span class="line"> */</span><br><span class="line">export function dpConvertTopx(dp) &#123;</span><br><span class="line">    return PixelRatio.getPixelSizeForLayoutSize(dp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="3-3-WEB端开发"><a href="#3-3-WEB端开发" class="headerlink" title="3.3 WEB端开发"></a>3.3 WEB端开发</h2><p>在写CSS时，我们用到最多的单位是px，即CSS像素，当页面缩放比例为100%时，一个CSS像素等于一个设备独立像素。</p>
<p>但是CSS像素是很容易被改变的，当用户对浏览器进行了放大，CSS像素会被放大，这时一个CSS像素会跨越更多的物理像素。</p>
<p>页面的缩放系数=CSS像素/设备独立像素。</p>
<h2 id="3-4-关于屏幕"><a href="#3-4-关于屏幕" class="headerlink" title="3.4 关于屏幕"></a>3.4 关于屏幕</h2><p>这里多说两句 Retina屏幕，因为我在很多文章中看到对 Retina屏幕的误解。</p>
<p>Retina屏幕只是苹果提出的一个营销术语：</p>
<blockquote>
<p>在普通的使用距离下，人的肉眼无法分辨单个的像素点。</p>
</blockquote>
<p>为什么强调 普通的使用距离下呢？我们来看一下它的计算公式：</p>
<p>$$ a=2arctan(h/2d) $$</p>
<p>a代表人眼视角，h代表像素间距，d代表肉眼与屏幕的距离，符合以上条件的屏幕可以使肉眼看不见单个物理像素点。</p>
<p>它不能单纯的表达分辨率和PPI，只能一种表达视觉效果。</p>
<p>让多个物理像素渲染一个独立像素只是Retina屏幕为了达到效果而使用的一种技术。而不是所有DPR&gt;1的屏幕就是Retina屏幕。</p>
<p>比如：给你一块超大尺寸的屏幕，即使它的PPI很高，DPR也很高，在近距离你也能看清它的像素点，这就不算Retina屏幕。<br><img src="/2019/06/03/关于移动端适配，你必须要知道的/13.webp" alt="13"><br>我们经常见到用K和P这个单位来形容屏幕：</p>
<p>P代表的就是屏幕纵向的像素个数，1080P即纵向有1080个像素，分辨率为1920X1080的屏幕就属于1080P屏幕。</p>
<p>我们平时所说的高清屏其实就是屏幕的物理分辨率达到或超过1920X1080的屏幕。</p>
<p>K代表屏幕横向有几个1024个像素，一般来讲横向像素超过2048就属于 2K屏，横向像素超过4096就属于4K屏。</p>
<h1 id="四、视口"><a href="#四、视口" class="headerlink" title="四、视口"></a>四、视口</h1><p>视口(viewport)代表当前可见的计算机图形区域。在Web浏览器术语中，通常与浏览器窗口相同，但不包括浏览器的UI， 菜单栏等——即指你正在浏览的文档的那一部分。</p>
<p>一般我们所说的视口共包括三种：布局视口、视觉视口和理想视口，它们在屏幕适配中起着非常重要的作用。</p>
<h2 id="4-1-布局视口"><a href="#4-1-布局视口" class="headerlink" title="4.1 布局视口"></a>4.1 布局视口</h2><p><img src="/2019/06/03/关于移动端适配，你必须要知道的/14.webp" alt="14"><br>布局视口(layout viewport)：当我们以百分比来指定一个元素的大小时，它的计算值是由这个元素的包含块计算而来的。当这个元素是最顶级的元素时，它就是基于布局视口来计算的。</p>
<p>所以，布局视口是网页布局的基准窗口，在PC浏览器上，布局视口就等于当前浏览器的窗口大小（不包括borders 、margins、滚动条）。</p>
<p>在移动端，布局视口被赋予一个默认值，大部分为980px，这保证PC的网页可以在手机浏览器上呈现，但是非常小，用户可以手动对网页进行放大。</p>
<p>我们可以通过调用 document.documentElement.clientWidth/clientHeight 来获取布局视口大小。</p>
<h2 id="4-2-视觉视口"><a href="#4-2-视觉视口" class="headerlink" title="4.2 视觉视口"></a>4.2 视觉视口</h2><p><img src="/2019/06/03/关于移动端适配，你必须要知道的/15.webp" alt="15"><br>视觉视口( visual viewport)：用户通过屏幕真实看到的区域。</p>
<p>视觉视口默认等于当前浏览器的窗口大小（包括滚动条宽度）。</p>
<p>当用户对浏览器进行缩放时，不会改变布局视口的大小，所以页面布局是不变的，但是缩放会改变视觉视口的大小。</p>
<p>例如：用户将浏览器窗口放大了 200%，这时浏览器窗口中的 CSS像素会随着视觉视口的放大而放大，这时一个CSS像素会跨越更多的物理像素。</p>
<p>所以，布局视口会限制你的CSS布局而视觉视口决定用户具体能看到什么。</p>
<p>我们可以通过调用 window.innerWidth/innerHeight来获取视觉视口大小。</p>
<h2 id="4-3-理想视口"><a href="#4-3-理想视口" class="headerlink" title="4.3 理想视口"></a>4.3 理想视口</h2><p><img src="/2019/06/03/关于移动端适配，你必须要知道的/16.webp" alt="16"><br>布局视口在移动端展示的效果并不是一个理想的效果，所以理想视口(ideal viewport)就诞生了：网站页面在移动端展示的理想大小。</p>
<p>如上图，我们在描述设备独立像素时曾使用过这张图，在浏览器调试移动端时页面上给定的像素大小就是理想视口大小，它的单位正是设备独立像素。</p>
<p>上面在介绍CSS像素时曾经提到 页面的缩放系数=CSS像素/设备独立像素，实际上说 页面的缩放系数=理想视口宽度/视觉视口宽度更为准确。</p>
<p>所以，当页面缩放比例为100%时，CSS像素=设备独立像素， 理想视口=视觉视口。</p>
<p>我们可以通过调用 screen.width/height来获取理想视口大小。</p>
<h2 id="4-4-Meta-viewport"><a href="#4-4-Meta-viewport" class="headerlink" title="4.4 Meta viewport"></a>4.4 Meta viewport</h2><p><meta>元素表示那些不能由其它HTML元相关元素之一表示的任何元数据信息，它可以告诉浏览器如何解析页面。</p>
<p>我们可以借助<meta>元素的viewport来帮助我们设置视口、缩放等，从而让移动端得到更好的展示效果。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width; initial-scale=1; maximum-scale=1; minimum-scale=1; user-scalable=no;&quot;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
<p>上面是 viewport的一个配置，我们来看看它们的具体含义：</p>
<table>
<thead>
<tr>
<th style="text-align:center">Value</th>
<th style="text-align:center">可能值</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">width</td>
<td style="text-align:center">正整数或 device-width</td>
<td style="text-align:center">以 pixels（像素）为单位， 定义布局视口的宽度。 </td>
</tr>
<tr>
<td style="text-align:center">height</td>
<td style="text-align:center">正整数或 device-height</td>
<td style="text-align:center">以 pixels（像素）为单位， 定义布局视口的高度。</td>
</tr>
<tr>
<td style="text-align:center">initial-scale</td>
<td style="text-align:center">0.0-10.0</td>
<td style="text-align:center">定义页面初始缩放比率。</td>
</tr>
<tr>
<td style="text-align:center">minimum-scale</td>
<td style="text-align:center">0.0-10.0</td>
<td style="text-align:center">定义缩放的最小值；必须小于或等于 maximum-scale的值。</td>
</tr>
<tr>
<td style="text-align:center">maximum-scale</td>
<td style="text-align:center">0.0-10.0</td>
<td style="text-align:center">定义缩放的最大值；必须大于或等于 minimum-scale的值。</td>
</tr>
<tr>
<td style="text-align:center">user-scalable</td>
<td style="text-align:center">一个布尔值（ yes或者 no）</td>
<td style="text-align:center">如果设置为 no，用户将不能放大或缩小网页。默认值为 yes。</td>
</tr>
</tbody>
</table>
<h2 id="4-5-移动端适配"><a href="#4-5-移动端适配" class="headerlink" title="4.5 移动端适配"></a>4.5 移动端适配</h2><p>为了在移动端让页面获得更好的显示效果，我们必须让布局视口、视觉视口都尽可能等于理想视口。</p>
<p>device-width就等于理想视口的宽度，所以设置 width=device-width 就相当于让布局视口等于理想视口。</p>
<p>由于 initial-scale=理想视口宽度/视觉视口宽度，所以我们设置 initial-scale=1;就相当于让视觉视口等于理想视口。</p>
<p>这时，1个CSS像素就等于1个设备独立像素，而且我们也是基于理想视口来进行布局的，所以呈现出来的页面布局在各种设备上都能大致相似。</p>
<h2 id="4-6-缩放"><a href="#4-6-缩放" class="headerlink" title="4.6 缩放"></a>4.6 缩放</h2><p>上面提到 width可以决定布局视口的宽度，实际上它并不是布局视口的唯一决定性因素，设置initial-scale也有肯能影响到布局视口，因为布局视口宽度取的是 width和视觉视口宽度的最大值。</p>
<p>例如：若手机的理想视口宽度为 400px，设置 width=device-width， initial-scale=2，此时视觉视口宽度=理想视口宽度/initial-scale即 200px，布局视口取两者最大值即 device-width 400px。</p>
<p>若设置 width=device-width， initial-scale=0.5，此时视觉视口宽度=理想视口宽度/initial-scale即800px，布局视口取两者最大值即 800px。</p>
<h2 id="4-7-获取浏览器大小"><a href="#4-7-获取浏览器大小" class="headerlink" title="4.7 获取浏览器大小"></a>4.7 获取浏览器大小</h2><p>浏览器为我们提供的获取窗口大小的 API有很多，下面我们再来对比一下：<br><img src="/2019/06/03/关于移动端适配，你必须要知道的/17.webp" alt="17"></p>
<ul>
<li>window.innerHeight：获取浏览器视觉视口高度（包括垂直滚动条）。</li>
<li>window.outerHeight：获取浏览器窗口外部的高度。表示整个浏览器窗口的高度，包括侧边栏、窗口镶边和调正窗口大小的边框。</li>
<li>window.screen.Height：获取获屏幕取理想视口高度，这个数值是固定的， 设备的分辨率/设备像素比</li>
<li>window.screen.availHeight：浏览器窗口可用的高度。</li>
<li>document.documentElement.clientHeight：获取浏览器布局视口高度，包括内边距，但不包括垂直滚动条、边框和外边距。</li>
<li>document.documentElement.offsetHeight：包括内边距、滚动条、边框和外边距。</li>
<li>document.documentElement.scrollHeight：在不使用滚动条的情况下适合视口中的所有内容所需的最小宽度。测量方式与 clientHeight相同：它包含元素的内边距，但不包括边框，外边距或垂直滚动条。</li>
</ul>
<h1 id="五、1px问题"><a href="#五、1px问题" class="headerlink" title="五、1px问题"></a>五、1px问题</h1><p>为了适配各种屏幕，我们写代码时一般使用设备独立像素来对页面进行布局。</p>
<p>而在设备像素比大于1的屏幕上，我们写的1px实际上是被多个物理像素渲染，这就会出现1px在有些屏幕上看起来很粗的现象。</p>
<h2 id="5-1-border-image"><a href="#5-1-border-image" class="headerlink" title="5.1 border-image"></a>5.1 border-image</h2><p>基于 media查询判断不同的设备像素比给定不同的 border-image：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">.border_1px&#123;</span><br><span class="line">      border-bottom: 1px solid #000;       </span><br><span class="line">       &#125;        </span><br><span class="line">       @media only screen and (-webkit-min-device-pixel-ratio:2)&#123;           </span><br><span class="line">        .border_1px&#123;</span><br><span class="line">              border-bottom: none;</span><br><span class="line">            border-width: 0 0 1px 0;</span><br><span class="line">            border-image: url(../img/1pxline.png) 0 0 2 0 stretch;            </span><br><span class="line">        &#125;        </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="5-2-background-image"><a href="#5-2-background-image" class="headerlink" title="5.2 background-image"></a>5.2 background-image</h2><p>和 border-image类似，准备一张符合条件的边框背景图，模拟在背景上。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">.border_1px&#123;</span><br><span class="line">          border-bottom: 1px solid #000;       </span><br><span class="line">       &#125;        </span><br><span class="line">       @media only screen and (-webkit-min-device-pixel-ratio:2)&#123;           </span><br><span class="line">        .border_1px&#123;</span><br><span class="line">            background: url(../img/1pxline.png) repeat-x left bottom;  </span><br><span class="line">            background-size: 100% 1px;          </span><br><span class="line">        &#125;        </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>上面两种都需要单独准备图片，而且圆角不是很好处理，但是可以应对大部分场景。</p>
<h2 id="5-3-伪类-transform"><a href="#5-3-伪类-transform" class="headerlink" title="5.3 伪类 + transform"></a>5.3 伪类 + transform</h2><p>基于 media查询判断不同的设备像素比对线条进行缩放：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">.border_1px:before&#123;</span><br><span class="line">            content:&quot;&quot; ;</span><br><span class="line">            position: absolute;</span><br><span class="line">            top: 0;</span><br><span class="line">            height: 1px;</span><br><span class="line">           width: 100%;</span><br><span class="line">           background-color: #000;</span><br><span class="line">           transform-origin: 50% 0%;</span><br><span class="line">          &#125;        </span><br><span class="line">          @media only screen and (-webkit-min-device-pixel-ratio:2)&#123;           </span><br><span class="line">           .border_1px:before&#123;</span><br><span class="line">               transeform: scaleY(0.5);        </span><br><span class="line">           &#125;        </span><br><span class="line">           @media only screen and (-webkit-min-device-pixel-ratio:3)&#123;           </span><br><span class="line">           .border_1px:before&#123;</span><br><span class="line">               transeform: scaleY(0.33);        </span><br><span class="line">           &#125;      </span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></p>
<p>这种方式可以满足各种场景，如果需要满足圆角，只需要给伪类也加上 border-radius即可。</p>
<h2 id="5-4-svg"><a href="#5-4-svg" class="headerlink" title="5.4 svg"></a>5.4 svg</h2><p>上面我们 border-image和 background-image都可以模拟 1px边框，但是使用的都是位图，还需要外部引入。</p>
<p>借助 PostCSS的 postcss-write-svg我们能直接使用 border-image和 background-image创建 svg的 1px边框：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@svg border_1px &#123;</span><br><span class="line"> height:   2px ;</span><br><span class="line"> @rect&#123;</span><br><span class="line">     fill:var(--color,black);</span><br><span class="line">     width:100%;</span><br><span class="line">     height:50%;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">.example &#123;</span><br><span class="line"> border: 1px solid transparent;</span><br><span class="line"> border-image: svg(border_1px param(--color #00b1ff)) 2 2 stretch;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></p>
<p>编译后：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">. example &#123;</span><br><span class="line">border :1px solid transparent;</span><br><span class="line"> border -image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns=&apos;http://www.w3.org/2000/svg&apos; height=&apos;2px&apos;%3E%3Crect fill=&apos;%2300b1ff&apos; width=&apos;100%25&apos; height=&apos;50%25&apos;/%3E%3C/svg%3E&quot;)</span><br></pre></td></tr></table></figure></p>
<p>上面的方案是大漠在他的文章中推荐使用的，基本可以满足所有场景，而且不需要外部引入，这是我个人比较喜欢的一种方案。</p>
<h2 id="5-5-viewport"><a href="#5-5-viewport" class="headerlink" title="5.5 viewport"></a>5.5 viewport</h2><p>通过设置缩放，让 CSS像素等于真正的物理像素。</p>
<p>例如：当设备像素比为 3时，我们将页面缩放 1/3倍，这时 1px等于一个真正的屏幕像素。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">const scale = 1 / window.devicePixelRatio;</span><br><span class="line">const viewport = document.querySelector(&apos;meta[name=&quot;viewport&quot;]&apos;);</span><br><span class="line">if (!viewport) &#123;</span><br><span class="line">    viewport = document.createElement(&apos;meta&apos;);</span><br><span class="line">    viewport.setAttribute(&apos;name&apos;, &apos;viewport&apos;);</span><br><span class="line">    window.document.head.appendChild(viewport);</span><br><span class="line">&#125;</span><br><span class="line">viewport.setAttribute(&apos;content&apos;, &apos;width=device-width,user-scalable=no,initial-scale=&apos; + scale + &apos;,maximum-scale=&apos; + scale + &apos;,minimum-scale=&apos;+ scale);</span><br></pre></td></tr></table></figure></p>
<p>实际上，上面这种方案是早先 flexible采用的方案。</p>
<p>当然，这样做是要付出代价的，这意味着你页面上所有的布局都要按照物理像素来写。这显然是不现实的，这时，我们可以借助 flexible或 vw、vh来帮助我们进行适配。</p>
<h1 id="六、移动端适配方案"><a href="#六、移动端适配方案" class="headerlink" title="六、移动端适配方案"></a>六、移动端适配方案</h1><p>尽管我们可以使用设备独立像素来保证各个设备在不同手机上显示的效果类似，但这并不能保证它们显示完全一致，我们需要一种方案来让设计稿得到更完美的适配。</p>
<h2 id="6-1-flexible方案"><a href="#6-1-flexible方案" class="headerlink" title="6.1 flexible方案"></a>6.1 flexible方案</h2><p>flexible方案是阿里早期开源的一个移动端适配解决方案，引用 flexible后，我们在页面上统一使用 rem来布局。</p>
<p>它的核心代码非常简单：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// set 1rem = viewWidth / 10</span><br><span class="line">function setRemUnit () &#123;</span><br><span class="line">var rem =docEl  . clientWidth   / 10  docEl .style .ontSize = rem  +&apos;px&apos; &#125;</span><br><span class="line">setRemUnit();</span><br></pre></td></tr></table></figure></p>
<p>rem 是相对于 html节点的 font-size来做计算的。</p>
<p>我们通过设置 document.documentElement.style.fontSize就可以统一整个页面的布局标准。</p>
<p>上面的代码中，将 html节点的 font-size设置为页面 clientWidth(布局视口)的 1/10，即 1rem就等于页面布局视口的 1/10，这就意味着我们后面使用的 rem都是按照页面比例来计算的。</p>
<p>这时，我们只需要将 UI出的图转换为 rem即可。</p>
<p>以 iPhone6为例：布局视口为 375px，则 1rem=37.5px，这时 UI给定一个元素的宽为 75px（设备独立像素），我们只需要将它设置为 75/37.5=2rem。</p>
<p>当然，每个布局都要计算非常繁琐，我们可以借助 PostCSS的 px2rem插件来帮助我们完成这个过程。</p>
<p>下面的代码可以保证在页面大小变化时，布局可以自适应，当触发了 window的 resize和 pageShow事件之后自动调整 html的 fontSize大小。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// reset rem unit on page resize</span><br><span class="line">window.addEventListener(&apos;resize&apos;, setRemUnit)</span><br><span class="line">window.addEventListener(&apos;pageshow&apos;, function (e) &#123;</span><br><span class="line">    if (e.persisted) &#123;setRemUnit()&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>由于 viewport单位得到众多浏览器的兼容，上面这种方案现在已经被官方弃用：</p>
<blockquote>
<p>lib-flexible这个过渡方案已经可以放弃使用，不管是现在的版本还是以前的版本，都存有一定的问题。建议大家开始使用viewport来替代此方案。</p>
</blockquote>
<p>下面我们来看看现在最流行的 vh、vw方案。</p>
<h2 id="6-2-vh-vw方案"><a href="#6-2-vh-vw方案" class="headerlink" title="6.2 vh,vw方案"></a>6.2 vh,vw方案</h2><p>vh、vw方案即将视觉视口宽度 window.innerWidth和视觉视口高度 window.innerHeight 等分为 100 份。</p>
<p>上面的 flexible方案就是模仿这种方案，因为早些时候 vw还没有得到很好的兼容。</p>
<ul>
<li>vw(Viewport’s width)： 1vw等于视觉视口的 1%</li>
<li>vh(Viewport’s height) : 1vh 为视觉视口高度的 1%</li>
<li>vmin : vw 和 vh 中的较小值</li>
<li>vmax : 选取 vw 和 vh 中的较大值<br><img src="/2019/06/03/关于移动端适配，你必须要知道的/18.webp" alt="18"></li>
</ul>
<p>如果视觉视口为 375px，那么 1vw=3.75px，这时 UI给定一个元素的宽为 75px（设备独立像素），我们只需要将它设置为 75/3.75=20vw。</p>
<p>这里的比例关系我们也不用自己换算，我们可以使用 PostCSS的 postcss-px-to-viewport 插件帮我们完成这个过程。写代码时，我们只需要根据 UI给的设计图写 px单位即可。</p>
<p>当然，没有一种方案是十全十美的， vw同样有一定的缺陷：</p>
<ul>
<li>px转换成 vw不一定能完全整除，因此有一定的像素差。</li>
<li>比如当容器使用 vw， margin采用 px时，很容易造成整体宽度超过 100vw，从而影响布局效果。当然我们也是可以避免的，例如使用 padding代替 margin，结合 calc()函数使用等等…</li>
</ul>
<h1 id="七、适配iPhone-X"><a href="#七、适配iPhone-X" class="headerlink" title="七、适配iPhone X"></a>七、适配iPhone X</h1><p>iPhoneX的出现将手机的颜值带上了一个新的高度，它取消了物理按键，改成了底部的小黑条，但是这样的改动给开发者适配移动端又增加了难度。</p>
<h1 id="7-1-安全区域"><a href="#7-1-安全区域" class="headerlink" title="7.1 安全区域"></a>7.1 安全区域</h1><p>在 iPhoneX发布后，许多厂商相继推出了具有边缘屏幕的手机。</p>
<p><img src="/2019/06/03/关于移动端适配，你必须要知道的/19.webp" alt="19"></p>
<p>这些手机和普通手机在外观上无外乎做了三个改动：圆角（ corners）、刘海（ sensor housing）和小黑条（ HomeIndicator）。为了适配这些手机，安全区域这个概念变诞生了：安全区域就是一个不受上面三个效果的可视窗口范围。</p>
<p>为了保证页面的显示效果，我们必须把页面限制在安全范围内，但是不影响整体效果。</p>
<h2 id="7-2-viewport-fit"><a href="#7-2-viewport-fit" class="headerlink" title="7.2 viewport-fit"></a>7.2 viewport-fit</h2><p>viewport-fit是专门为了适配 iPhoneX而诞生的一个属性，它用于限制网页如何在安全区域内进行展示。</p>
<p><img src="/2019/06/03/关于移动端适配，你必须要知道的/20.webp" alt="20"></p>
<p>contain: 可视窗口完全包含网页内容</p>
<p>cover：网页内容完全覆盖可视窗口</p>
<p>默认情况下或者设置为 auto和 contain效果相同。</p>
<h2 id="7-3-env、constant"><a href="#7-3-env、constant" class="headerlink" title="7.3 env、constant"></a>7.3 env、constant</h2><p><img src="/2019/06/03/关于移动端适配，你必须要知道的/21.webp" alt="21"><br>我们需要将顶部和底部合理的摆放在安全区域内， iOS11新增了两个 CSS函数 env、constant，用于设定安全区域与边界的距离。</p>
<p>函数内部可以是四个常量：</p>
<ul>
<li>safe-area-inset-left：安全区域距离左边边界距离</li>
<li>safe-area-inset-right：安全区域距离右边边界距离</li>
<li>safe-area-inset-top：安全区域距离顶部边界距离</li>
<li>safe-area-inset-bottom：安全区域距离底部边界距离</li>
</ul>
<p>注意：我们必须指定 viweport-fit后才能使用这两个函数：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=&quot;viewport&quot; content=&quot;viewport-fit=cover&quot;&gt;</span><br></pre></td></tr></table></figure></p>
<p>constant在 iOS&lt;11.2的版本中生效， env在 iOS&gt;=11.2的版本中生效，这意味着我们往往要同时设置他们，将页面限制在安全区域内：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">body&#123;</span><br><span class="line">    padding - bottom:constant(safe - area - inset - bottom);</span><br><span class="line">    padding - bottom:env(safe - area - inset - bottom);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当使用底部固定导航栏时，我们要为他们设置 padding值：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    padding - bottom: constant(safe - area - inset - bottom);</span><br><span class="line">    padding - bottom: env(safe - area - inset - bottom);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="八、横屏适配"><a href="#八、横屏适配" class="headerlink" title="八、横屏适配"></a>八、横屏适配</h1><p><img src="/2019/06/03/关于移动端适配，你必须要知道的/22.webp" alt="22"></p>
<p>很多视口我们要对横屏和竖屏显示不同的布局，所以我们需要检测在不同的场景下给定不同的样式：</p>
<h2 id="8-1-JavaScript检测横屏"><a href="#8-1-JavaScript检测横屏" class="headerlink" title="8.1 JavaScript检测横屏"></a>8.1 JavaScript检测横屏</h2><p>window.orientation:获取屏幕旋转方向<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">window.addEventListener (     &quot;resize&quot;     , ()=&gt;&#123;</span><br><span class="line">    if (window.orientation === 180 || window.orientation === 0) &#123;</span><br><span class="line">            // 正常方向或屏幕旋转180度</span><br><span class="line">        console.log(&apos;竖屏&apos;);</span><br><span class="line">    &#125;;</span><br><span class="line">    if (window.orientation === 90 || window.orientation === -90)&#123;</span><br><span class="line">        // 屏幕顺时钟旋转90度或屏幕逆时针旋转90度</span><br><span class="line">        console.log(&apos;横屏&apos;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h2 id="8-2-css检测横屏"><a href="#8-2-css检测横屏" class="headerlink" title="8.2 css检测横屏"></a>8.2 css检测横屏</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@mediascreen and(orientation:portrait)&#123;/*竖屏...*/&#125;</span><br><span class="line">@mediascreen and(orientation:landscape)&#123;/*横屏...*/&#125;</span><br></pre></td></tr></table></figure>
<h1 id="九、图片模糊问题"><a href="#九、图片模糊问题" class="headerlink" title="九、图片模糊问题"></a>九、图片模糊问题</h1><h2 id="9-1-产生原因"><a href="#9-1-产生原因" class="headerlink" title="9.1 产生原因"></a>9.1 产生原因</h2><p>我们平时使用的图片大多数都属于位图（ png、jpg…），位图由一个个像素点构成的，每个像素都具有特定的位置和颜色值：</p>
<p><img src="/2019/06/03/关于移动端适配，你必须要知道的/23.webp" alt="23"></p>
<p>理论上，位图的每个像素对应在屏幕上使用一个物理像素来渲染，才能达到最佳的显示效果。</p>
<p>而在 dpr&gt;1的屏幕上，位图的一个像素可能由多个物理像素来渲染，然而这些物理像素点并不能被准确的分配上对应位图像素的颜色，只能取近似值，所以相同的图片在 dpr&gt;1的屏幕上就会模糊:</p>
<p><img src="/2019/06/03/关于移动端适配，你必须要知道的/24.webp" alt="24"></p>
<h2 id="9-2-解决方案"><a href="#9-2-解决方案" class="headerlink" title="9.2 解决方案"></a>9.2 解决方案</h2><p>为了保证图片质量，我们应该尽可能让一个屏幕像素来渲染一个图片像素，所以，针对不同 DPR的屏幕，我们需要展示不同分辨率的图片。</p>
<p>如：在 dpr=2的屏幕上展示两倍图 (@2x)，在 dpr=3的屏幕上展示三倍图 (@3x)。<br><img src="/2019/06/03/关于移动端适配，你必须要知道的/25.webp" alt="25"></p>
<h2 id="9-3-media查询"><a href="#9-3-media查询" class="headerlink" title="9.3 media查询"></a>9.3 media查询</h2><p>使用 media查询判断不同的设备像素比来显示不同精度的图片：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">.avatar&#123;</span><br><span class="line">    background - image:url(conardLi_1x         .         png);</span><br><span class="line">&#125;</span><br><span class="line">@mediaonly screenand(-webkit - min - device - pixel - ratio:2)&#123;</span><br><span class="line">.avatar&#123;</span><br><span class="line">        background - image:url(conardLi_2x.png);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@mediaonly screenand(-webkit - min - device - pixel - ratio:3)&#123;</span><br><span class="line">.avatar&#123;</span><br><span class="line">    background - image:url(conardLi_3x.png);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>只适用于背景图</p>
</blockquote>
<h2 id="9-4-image-set"><a href="#9-4-image-set" class="headerlink" title="9.4 image-set"></a>9.4 image-set</h2><p>使用 image-set：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.avatar&#123;</span><br><span class="line">    background - image:-webkit - image - set(&quot;conardLi_1x.png&quot;1x, &quot;conardLi_2x.png&quot;2x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>只适用于背景图</p>
</blockquote>
<h2 id="9-5-srcset"><a href="#9-5-srcset" class="headerlink" title="9.5 srcset"></a>9.5 srcset</h2><p>使用 img标签的 srcset属性，浏览器会自动根据像素密度匹配最佳显示图片：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;conardLi_1x.png&quot; srcSet=&quot; conardLi_2x.png 2x, conardLi_3x.png 3x&quot;&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="9-6-JavaScript拼接图片url"><a href="#9-6-JavaScript拼接图片url" class="headerlink" title="9.6 JavaScript拼接图片url"></a>9.6 JavaScript拼接图片url</h2><p>使用 window.devicePixelRatio获取设备像素比，遍历所有图片，替换图片地址：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">const dpr = window.devicePixelRatio;</span><br><span class="line">const images = document.querySelectorAll(&apos;img&apos;);</span><br><span class="line">images.forEach((img)=&gt;&#123;</span><br><span class="line">        img.src.replace(&quot;.&quot;, `@$&#123;dpr&#125;x.`);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="9-7-使用svg"><a href="#9-7-使用svg" class="headerlink" title="9.7 使用svg"></a>9.7 使用svg</h2><p>SVG的全称是可缩放矢量图（ ScalableVectorGraphics）。不同于位图的基于像素， SVG 则是属于对图像的形状描述，所以它本质上是文本文件，体积较小，且不管放大多少倍都不会失真。</p>
<p><img src="/2019/06/03/关于移动端适配，你必须要知道的/26.webp" alt="26"><br>除了我们手动在代码中绘制 svg，我们还可以像使用位图一样使用 svg图片：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;conardLi.svg&quot;&gt;</span><br><span class="line">&lt;img src=&quot;data:image/svg+xml;base64,[data]&quot;&gt;</span><br><span class="line">.avatar&#123;</span><br><span class="line">    background:url(conardLi.svg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/前端/" rel="tag"># 前端</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/02/13/学会这两件事，让你成为Git老司机/" rel="next" title="学会这两件事，让你成为Git老司机">
                <i class="fa fa-chevron-left"></i> 学会这两件事，让你成为Git老司机
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/06/04/前端面试题深入解析-01/" rel="prev" title="前端面试题深入解析-01">
                前端面试题深入解析-01 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.gif"
                alt="Charli" />
            
              <p class="site-author-name" itemprop="name">Charli</p>
              <p class="site-description motion-element" itemprop="description">不积跬步，无以至千里</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">49</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">11</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">24</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/lifuzhen" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
            </div>
          

          
          

          
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#一、英寸"><span class="nav-number">1.</span> <span class="nav-text">一、英寸</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#二、分辨率"><span class="nav-number">2.</span> <span class="nav-text">二、分辨率</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-像素"><span class="nav-number">2.1.</span> <span class="nav-text">2.1 像素</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2-屏幕分辨率"><span class="nav-number">2.2.</span> <span class="nav-text">2.2 屏幕分辨率</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3-图像分辨率"><span class="nav-number">2.3.</span> <span class="nav-text">2.3 图像分辨率</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-4-PPI"><span class="nav-number">2.4.</span> <span class="nav-text">2.4 PPI</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-5-DPI"><span class="nav-number">2.5.</span> <span class="nav-text">2.5 DPI</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#三、设备独立像素"><span class="nav-number">3.</span> <span class="nav-text">三、设备独立像素</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-设备像素比"><span class="nav-number">3.1.</span> <span class="nav-text">3.1 设备像素比</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-移动端开发"><span class="nav-number">3.2.</span> <span class="nav-text">3.2 移动端开发</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3-WEB端开发"><span class="nav-number">3.3.</span> <span class="nav-text">3.3 WEB端开发</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4-关于屏幕"><span class="nav-number">3.4.</span> <span class="nav-text">3.4 关于屏幕</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#四、视口"><span class="nav-number">4.</span> <span class="nav-text">四、视口</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1-布局视口"><span class="nav-number">4.1.</span> <span class="nav-text">4.1 布局视口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2-视觉视口"><span class="nav-number">4.2.</span> <span class="nav-text">4.2 视觉视口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-3-理想视口"><span class="nav-number">4.3.</span> <span class="nav-text">4.3 理想视口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-4-Meta-viewport"><span class="nav-number">4.4.</span> <span class="nav-text">4.4 Meta viewport</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-5-移动端适配"><span class="nav-number">4.5.</span> <span class="nav-text">4.5 移动端适配</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-6-缩放"><span class="nav-number">4.6.</span> <span class="nav-text">4.6 缩放</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-7-获取浏览器大小"><span class="nav-number">4.7.</span> <span class="nav-text">4.7 获取浏览器大小</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#五、1px问题"><span class="nav-number">5.</span> <span class="nav-text">五、1px问题</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#5-1-border-image"><span class="nav-number">5.1.</span> <span class="nav-text">5.1 border-image</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-2-background-image"><span class="nav-number">5.2.</span> <span class="nav-text">5.2 background-image</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-3-伪类-transform"><span class="nav-number">5.3.</span> <span class="nav-text">5.3 伪类 + transform</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-4-svg"><span class="nav-number">5.4.</span> <span class="nav-text">5.4 svg</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-5-viewport"><span class="nav-number">5.5.</span> <span class="nav-text">5.5 viewport</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#六、移动端适配方案"><span class="nav-number">6.</span> <span class="nav-text">六、移动端适配方案</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#6-1-flexible方案"><span class="nav-number">6.1.</span> <span class="nav-text">6.1 flexible方案</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-2-vh-vw方案"><span class="nav-number">6.2.</span> <span class="nav-text">6.2 vh,vw方案</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#七、适配iPhone-X"><span class="nav-number">7.</span> <span class="nav-text">七、适配iPhone X</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#7-1-安全区域"><span class="nav-number">8.</span> <span class="nav-text">7.1 安全区域</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#7-2-viewport-fit"><span class="nav-number">8.1.</span> <span class="nav-text">7.2 viewport-fit</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-3-env、constant"><span class="nav-number">8.2.</span> <span class="nav-text">7.3 env、constant</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#八、横屏适配"><span class="nav-number">9.</span> <span class="nav-text">八、横屏适配</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#8-1-JavaScript检测横屏"><span class="nav-number">9.1.</span> <span class="nav-text">8.1 JavaScript检测横屏</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-2-css检测横屏"><span class="nav-number">9.2.</span> <span class="nav-text">8.2 css检测横屏</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#九、图片模糊问题"><span class="nav-number">10.</span> <span class="nav-text">九、图片模糊问题</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#9-1-产生原因"><span class="nav-number">10.1.</span> <span class="nav-text">9.1 产生原因</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-2-解决方案"><span class="nav-number">10.2.</span> <span class="nav-text">9.2 解决方案</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-3-media查询"><span class="nav-number">10.3.</span> <span class="nav-text">9.3 media查询</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-4-image-set"><span class="nav-number">10.4.</span> <span class="nav-text">9.4 image-set</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-5-srcset"><span class="nav-number">10.5.</span> <span class="nav-text">9.5 srcset</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-6-JavaScript拼接图片url"><span class="nav-number">10.6.</span> <span class="nav-text">9.6 JavaScript拼接图片url</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-7-使用svg"><span class="nav-number">10.7.</span> <span class="nav-text">9.7 使用svg</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2023</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Charli</span>

  

  
</div>




  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动 v3.7.1</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a class="theme-link" target="_blank" href="https://theme-next.org">NexT.Pisces</a> v6.4.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>
















  
  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three.min.js"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three-waves.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.4.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.4.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.4.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.4.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.4.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.4.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.4.0"></script>



  



  








  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  
  
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(function (item) {
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'bQj0duOu4duPTzRWh3nmNqNG-gzGzoHsz',
        appKey: '8RVBaAkuHUkExbSP4g6iSYcf',
        placeholder: '聊五毛钱的天呗',
        avatar:'mm',
        meta:guest,
        pageSize:'10' || 10,
        visitor: false
    });
  </script>



  





  

  
  <script>
    
    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();

      Counter('get', '/classes/Counter', { where: JSON.stringify({ url }) })
        .done(function ({ results }) {
          if (results.length > 0) {
            var counter = results[0];
            
            Counter('put', `/classes/Counter/${counter.objectId}`, JSON.stringify({ time: { "__op":"Increment", "amount":1 } }))
            
            .done(function () {
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(counter.time + 1);
            })
            
            .fail(function ({ responseJSON }) {
                console.log('Failed to save Visitor num, with error message: ' + responseJSON.error);
            })
          } else {
            
              var $element = $(document.getElementById(url));
              $element.find('.leancloud-visitors-count').text('Counter not initialized! See more at console err msg.');
              console.error('ATTENTION! LeanCloud counter has security bug, see here how to solve it: https://github.com/theme-next/hexo-leancloud-counter-security. \n But you also can use LeanCloud without security, by set \'security\' option to \'false\'.');
            
          }
        })
      .fail(function ({ responseJSON }) {
        console.log('LeanCloud Counter Error:' + responseJSON.code + " " + responseJSON.error);
      });
    }
    

    $(function() {
      $.get('https://app-router.leancloud.cn/2/route?appId=' + "bQj0duOu4duPTzRWh3nmNqNG-gzGzoHsz")
        .done(function ({ api_server }) {
          var Counter = function (method, url, data) {
            return $.ajax({
              method: method,
              url: `https://${api_server}/1.1${url}`,
              headers: {
                'X-LC-Id': "bQj0duOu4duPTzRWh3nmNqNG-gzGzoHsz",
                'X-LC-Key': "8RVBaAkuHUkExbSP4g6iSYcf",
                'Content-Type': 'application/json',
              },
              data: data,
            });
          };
          
          addCount(Counter);
          
        })
    });
  </script>



  

  

  

  
  

  

  

  

  

  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("bQj0duOu4duPTzRWh3nmNqNG-gzGzoHsz", "8RVBaAkuHUkExbSP4g6iSYcf");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



</body>
</html>
